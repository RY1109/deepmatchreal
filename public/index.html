<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DeepMatch Pro</title>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <div class="lang-switch" onclick="toggleLanguage()">
            <i class="fas fa-globe"></i> <span id="current-lang-text">EN</span>
        </div>
        <div id="offline-tip" class="status-bar" data-i18n="offlineTip">网络已断开，正在尝试重连...</div>

        <!-- 首页 -->
        <div id="page-home" class="page active">
            <div class="home-content">
                <div class="hero-title" data-i18n="appTitle">DeepMatch</div>
                <div class="online-badge">🟢 <span data-i18n="onlineLabel">当前在线</span>: <span id="online-count">1</span></div>
                <div class="input-wrapper">
                    <textarea id="userInput" data-i18n-placeholder="inputPlaceholder" placeholder="输入话题..."></textarea>
                    <div style="overflow: hidden;">
                        <button class="btn-start" onclick="startMatching()">
                            <span data-i18n="btnStart">开始匹配</span> <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 加载页 -->
        <div id="page-loading" class="page" style="align-items: center; justify-content: center;">
            <i class="fas fa-circle-notch fa-spin" style="font-size: 2rem; color: var(--ds-blue);"></i>
            <p style="margin-top: 20px; color: var(--text-sub);" id="loading-text" data-i18n="loadingText">正在寻找伙伴...</p>
            <button onclick="location.reload()" style="margin-top: 30px; border:none; background:none; color:#999;" data-i18n="btnCancel">取消</button>
        </div>

        <!-- 聊天页 -->
        <div id="page-chat" class="page">
            <header class="chat-header">
                <div class="partner-info">
                    <div class="avatar"><img id="partner-avatar-img" src=""></div>
                    <div>
                        <div style="font-weight: 600;" id="partner-name" data-i18n="partnerName">神秘玩家</div>
                        <div style="font-size: 0.75rem; color: #22c55e;" id="match-status">● 匹配成功</div>
                    </div>
                </div>
                <!-- 退出按钮 -->
                <i class="fas fa-sign-out-alt" onclick="clearSession()" style="color: #999; cursor: pointer;"></i>
            </header>

            <div class="chat-body" id="chatBody"></div>

            <div class="typing-indicator" id="typing-indicator">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div> <span data-i18n="typing">对方正在输入...</span>
            </div>

            <div class="input-bar">
                <input type="text" class="chat-input" id="chatInput" data-i18n-placeholder="chatPlaceholder" placeholder="发消息..." autocomplete="off">
                <button onclick="sendMsg()" style="background:var(--ds-blue); color:white; border:none; width:36px; height:36px; border-radius:50%;"><i class="fas fa-arrow-up"></i></button>
            </div>
        </div>
    </div>

    <!-- 脚本引入顺序很重要 -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/app.js"></script>
</body>
</html>